<!DOCTYPE html>
<html>
<head>
<title>Data Structures Course: Set Simulator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f0f0f0;
    color: #333;
    text-align: center;
    margin: 0;
    padding: 20px;
  }
  .controls {
    margin: 20px;
  }
  input {
    padding: 8px;
    margin: 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
    width: 120px;
  }
  button {
    padding: 8px 15px;
    margin: 5px;
    border: none;
    background-color: #4CAF50;
    color: white;
    border-radius: 4px;
    cursor: pointer;
  }
  button:hover {
    background-color: #45a049;
  }
  svg {
    border: 1px solid #ccc;
    background-color: white;
    margin-top: 20px;
  }
  .node {
    cursor: pointer;
    stroke: #fff;
    stroke-width: 2px;
  }
  .link {
    stroke: #666;
    stroke-width: 2px;
  }
</style>
</head>
<body>
<h1>Set Data Structure Simulator</h1>
<div class="controls">
  <input id="elementInput" type="number" placeholder="Add element">
  <button onclick="addElement()">Add</button>
  <input id="union1" type="number" placeholder="Set 1">
  <input id="union2" type="number" placeholder="Set 2">
  <button onclick="unionSets()">Union</button>
  <input id="findElement" type="number" placeholder="Find element">
  <button onclick="findElement()">Find</button>
  <button onclick="reset()">Reset</button>
</div>
<svg id="canvas" width="800" height="400"></svg>

<script>
let nodes = [];
let links = [];
let sets = new Map();
let nextId = 0;

const svg = document.getElementById('canvas');
let isDragging = false;
let dragNode = null;
let lastMousePos = { x: 0, y: 0 };

function initializeSet(value) {
  if (!sets.has(value)) {
    sets.set(value, value);
    nodes.push({
      id: nextId++,
      value: value,
      x: Math.random() * 700 + 50,
      y: Math.random() * 300 + 50,
    });
    updateVisualization();
  }
}

function addElement() {
  const value = parseInt(document.getElementById('elementInput').value);
  if (!isNaN(value)) {
    initializeSet(value);
    updateSetColors();
  }
}

function reset() {
  nodes = [];
  links = [];
  sets.clear();
  nextId = 0;
  svg.innerHTML = '';
}

function updateVisualization() {
  svg.innerHTML = '';

  links.forEach(link => {
    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
    line.setAttribute('class', 'link');
    line.setAttribute('x1', link.source.x);
    line.setAttribute('y1', link.source.y);
    line.setAttribute('x2', link.target.x);
    line.setAttribute('y2', link.target.y);
    svg.appendChild(line);
  });

  nodes.forEach(node => {
    const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
    group.setAttribute('transform', `translate(${node.x},${node.y})`);

    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
    circle.setAttribute('class', 'node');
    circle.setAttribute('r', 20);
    circle.dataset.value = node.value;

    circle.addEventListener('mousedown', (e) => startDrag(e, node));

    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    text.textContent = node.value;
    text.setAttribute('text-anchor', 'middle');
    text.setAttribute('dy', '.3em');

    group.appendChild(circle);
    group.appendChild(text);
    svg.appendChild(group);
  });

  updateSetColors();
}

function startDrag(event, node) {
  isDragging = true;
  dragNode = node;
  lastMousePos = { x: event.offsetX, y: event.offsetY };
}

function drag(event) {
  if (!isDragging || !dragNode) return;

  const dx = event.offsetX - lastMousePos.x;
  const dy = event.offsetY - lastMousePos.y;

  if (Math.abs(dx) < 5 && Math.abs(dy) < 5) return;

  dragNode.x += dx;
  dragNode.y += dy;

  lastMousePos = { x: event.offsetX, y: event.offsetY };
  updateVisualization();
}

function endDrag() {
  isDragging = false;
  dragNode = null;
}

function unionSets() {
  const set1 = parseInt(document.getElementById('union1').value);
  const set2 = parseInt(document.getElementById('union2').value);
  const root1 = find(set1);
  const root2 = find(set2);

  if (root1 !== null && root2 !== null && root1 !== root2) {
    sets.set(root2, root1);
    links.push({
      source: nodes.find(node => node.value === root1),
      target: nodes.find(node => node.value === root2)
    });
    updateVisualization();
  }
}

function find(value) {
  if (!sets.has(value)) return null;
  let parent = value;
  while (parent !== sets.get(parent)) {
    parent = sets.get(parent);
  }
  return parent;
}

function findElement() {
  const value = parseInt(document.getElementById('findElement').value);
  const root = find(value);

  if (root !== null) {
    const circle = svg.querySelector(`circle[data-value="${root}"]`);
    if (circle) {
      circle.style.stroke = 'yellow';
      circle.style.strokeWidth = '4px';

      // 1 saniye sonra eski haline döndür
      setTimeout(() => {
        circle.style.stroke = 'black';
        circle.style.strokeWidth = '1px';
      }, 1000);
    }
  } else {
    alert('Element not found in any set.');
  }
}

function updateSetColors() {
  const colors = [
    '#e41a1c', '#377eb8', '#4daf4a', '#ff7f00', '#984ea3',
    '#ffff33', '#a65628', '#f781bf', '#999999', '#66c2a5',
    '#fc8d62', '#8da0cb', '#e78ac3', '#a6d854', '#ffd92f',
    '#e5c494', '#b3b3b3', '#1b9e77', '#d95f02', '#7570b3'
  ];

  const rootColors = new Map();

  // Her kök düğüme bir renk atayın
  nodes.forEach(node => {
    const root = find(node.value);
    if (!rootColors.has(root)) {
      const colorIndex = rootColors.size % colors.length;
      rootColors.set(root, colors[colorIndex]);
    }
  });

  // Düğümleri köklerinin rengine göre renklendir
  nodes.forEach(node => {
    const root = find(node.value);
    const color = rootColors.get(root);
    const circle = svg.querySelector(`circle[data-value="${node.value}"]`);
    if (circle) {
      circle.style.fill = color;
    }
  });
}

// Fare olaylarını SVG'ye bağlama
svg.addEventListener('mousemove', drag);
svg.addEventListener('mouseup', endDrag);
svg.addEventListener('mouseleave', endDrag);

// Varsayılan düğümler
[1, 2, 3, 4, 5].forEach(initializeSet);
</script>
